<div class="admin-section">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3>系统设置</h3>
        <button class="action-btn" style="background-color: rgba(52, 152, 219, 0.7);" onclick="loadContent('admin_home')">返回首页</button>
    </div>
    <p>配置系统参数和选项</p>

    <div class="tabs">
        <div class="tab active" data-tab="general-settings">基本设置</div>
        <div class="tab" data-tab="security-settings">安全设置</div>
        <div class="tab" data-tab="display-settings">显示设置</div>
        <div class="tab" data-tab="backup-settings">备份设置</div>
    </div>

    <div class="tab-content active" id="general-settings">
        <form id="general-settings-form">
            <div class="form-group">
                <label for="site-name">网站名称</label>
                <input type="text" id="site-name" class="form-control" value="藏药植物药知识平台">
            </div>
            <div class="form-group">
                <label for="site-description">网站描述</label>
                <textarea id="site-description" class="form-control" rows="3">藏药植物药知识平台是一个专注于藏医药植物研究与知识分享的专业平台。</textarea>
            </div>
            <div class="form-group">
                <label for="admin-email">管理员邮箱</label>
                <input type="email" id="admin-email" class="form-control" value="admin@example.com">
            </div>
            <div class="form-group">
                <label for="items-per-page">每页显示条目数</label>
                <select id="items-per-page" class="form-control">
                    <option value="10">10</option>
                    <option value="20" selected>20</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
            <div class="form-group">
                <label>系统语言</label>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="radio" name="language" value="zh" checked style="margin-right: 10px;"> 中文
                    </label>
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="radio" name="language" value="en" style="margin-right: 10px;"> 英文
                    </label>
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="radio" name="language" value="bo" style="margin-right: 10px;"> 藏文
                    </label>
                </div>
            </div>
            <button type="submit" class="submit-btn">保存设置</button>
        </form>
    </div>

    <div class="tab-content" id="security-settings">
        <form id="security-settings-form">
            <div class="form-group">
                <label for="password-min-length">密码最小长度</label>
                <input type="number" id="password-min-length" class="form-control" value="8" min="6" max="20">
            </div>
            <div class="form-group">
                <label for="password-complexity">密码复杂度要求</label>
                <select id="password-complexity" class="form-control">
                    <option value="low">低 (仅字母和数字)</option>
                    <option value="medium" selected>中 (字母、数字和特殊字符)</option>
                    <option value="high">高 (大小写字母、数字和特殊字符)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="session-timeout">会话超时时间 (分钟)</label>
                <input type="number" id="session-timeout" class="form-control" value="30" min="5" max="120">
            </div>
            <div class="form-group">
                <label>登录安全选项</label>
                <div style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="enable-captcha" checked style="margin-right: 10px;"> 启用验证码
                    </label>
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="login-attempts" checked style="margin-right: 10px;"> 限制登录尝试次数
                    </label>
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="checkbox" id="ip-restriction" style="margin-right: 10px;"> 启用IP限制
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="max-login-attempts">最大登录尝试次数</label>
                <input type="number" id="max-login-attempts" class="form-control" value="5" min="3" max="10">
            </div>
            <button type="submit" class="submit-btn">保存设置</button>
        </form>
    </div>

    <div class="tab-content" id="display-settings">
        <form id="display-settings-form">
            <div class="form-group">
                <label for="theme-color">主题颜色</label>
                <select id="theme-color" class="form-control">
                    <option value="purple" selected>紫色 (默认)</option>
                    <option value="blue">蓝色</option>
                    <option value="green">绿色</option>
                    <option value="red">红色</option>
                </select>
            </div>
            <div class="form-group">
                <label for="font-size">字体大小</label>
                <select id="font-size" class="form-control">
                    <option value="small">小</option>
                    <option value="medium" selected>中</option>
                    <option value="large">大</option>
                </select>
            </div>
            <div class="form-group">
                <label>布局选项</label>
                <div style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="show-sidebar" checked style="margin-right: 10px;"> 显示侧边栏
                    </label>
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="fixed-header" checked style="margin-right: 10px;"> 固定顶部导航栏
                    </label>
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="checkbox" id="show-footer" checked style="margin-right: 10px;"> 显示页脚
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="homepage-layout">首页布局</label>
                <select id="homepage-layout" class="form-control">
                    <option value="grid" selected>网格布局</option>
                    <option value="list">列表布局</option>
                    <option value="card">卡片布局</option>
                </select>
            </div>
            <button type="submit" class="submit-btn">保存设置</button>
            <button type="button" class="action-btn" style="background-color: rgba(52, 152, 219, 0.7); margin-left: 10px;" onclick="previewTheme()">预览</button>
            <button type="button" class="action-btn" style="background-color: rgba(231, 76, 60, 0.7); margin-left: 10px;" onclick="resetDisplaySettings()">重置为默认</button>
        </form>
    </div>

    <div class="tab-content" id="backup-settings">
        <form id="backup-settings-form">
            <div class="form-group">
                <label for="auto-backup">自动备份</label>
                <select id="auto-backup" class="form-control">
                    <option value="disabled">禁用</option>
                    <option value="daily" selected>每天</option>
                    <option value="weekly">每周</option>
                    <option value="monthly">每月</option>
                </select>
            </div>
            <div class="form-group">
                <label for="backup-time">备份时间</label>
                <input type="time" id="backup-time" class="form-control" value="03:00">
            </div>
            <div class="form-group">
                <label for="backup-retention">备份保留时间 (天)</label>
                <input type="number" id="backup-retention" class="form-control" value="30" min="7" max="365">
            </div>
            <div class="form-group">
                <label>备份内容</label>
                <div style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="backup-database" checked style="margin-right: 10px;"> 数据库
                    </label>
                    <label style="display: flex; align-items: center; color: white; margin-bottom: 10px;">
                        <input type="checkbox" id="backup-files" checked style="margin-right: 10px;"> 文件
                    </label>
                    <label style="display: flex; align-items: center; color: white;">
                        <input type="checkbox" id="backup-config" checked style="margin-right: 10px;"> 配置文件
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="backup-location">备份存储位置</label>
                <select id="backup-location" class="form-control">
                    <option value="local" selected>本地服务器</option>
                    <option value="cloud">云存储</option>
                    <option value="both">本地和云存储</option>
                </select>
            </div>
            <button type="submit" class="submit-btn">保存设置</button>
            <button type="button" class="action-btn" style="background-color: rgba(46, 204, 113, 0.7); margin-left: 10px;" onclick="manualBackup()">立即备份</button>
            <button type="button" class="action-btn" style="background-color: rgba(52, 152, 219, 0.7); margin-left: 10px;" onclick="restoreBackup()">恢复备份</button>
        </form>
    </div>
</div>

<script>
    $(document).ready(function() {
        // 初始化标签页切换
        $('.tab').click(function() {
            $('.tab').removeClass('active');
            $(this).addClass('active');
            
            const tabId = $(this).data('tab');
            $('.tab-content').removeClass('active');
            $(`#${tabId}`).addClass('active');
        });

        // 初始化表单提交
        $('#general-settings-form').submit(function(e) {
            e.preventDefault();
            saveSettings('general');
        });

        $('#security-settings-form').submit(function(e) {
            e.preventDefault();
            saveSettings('security');
        });

        $('#display-settings-form').submit(function(e) {
            e.preventDefault();
            saveSettings('display');
        });

        $('#backup-settings-form').submit(function(e) {
            e.preventDefault();
            saveSettings('backup');
        });
    });

    // 保存设置
    function saveSettings(type) {
        // 显示加载动画
        $('body').append('<div class="loader" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;"></div>');
        
        // 模拟保存过程
        setTimeout(function() {
            $('.loader').remove();
            alert(`${type}设置保存成功！`);
        }, 1000);
    }

    // 预览主题
    function previewTheme() {
        const themeColor = $('#theme-color').val();
        const fontSize = $('#font-size').val();
        
        // 这里可以添加实际的主题预览逻辑
        alert(`正在预览主题：颜色=${themeColor}，字体大小=${fontSize}`);
    }

    // 重置显示设置
    function resetDisplaySettings() {
        if (confirm('确定要重置所有显示设置为默认值吗？')) {
            $('#theme-color').val('purple');
            $('#font-size').val('medium');
            $('#show-sidebar').prop('checked', true);
            $('#fixed-header').prop('checked', true);
            $('#show-footer').prop('checked', true);
            $('#homepage-layout').val('grid');
            
            alert('显示设置已重置为默认值。');
        }
    }

    // 手动备份
    function manualBackup() {
        // 显示加载动画
        $('body').append('<div class="loader" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;"></div>');
        
        // 模拟备份过程
        setTimeout(function() {
            $('.loader').remove();
            alert('系统备份已完成！');
        }, 2000);
    }

    // 恢复备份
    function restoreBackup() {
        // 创建模态框
        $('body').append(`
            <div id="restore-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                <div style="width: 80%; max-width: 600px; background-color: rgba(30, 30, 30, 0.9); backdrop-filter: blur(10px); border-radius: 10px; padding: 20px; max-height: 80vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3 style="color: white;">恢复备份</h3>
                        <button onclick="closeRestoreModal()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">×</button>
                    </div>
                    <div style="color: white;">
                        <p>选择要恢复的备份：</p>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="radio" name="backup-file" id="backup-1" style="margin-right: 10px;">
                                <label for="backup-1">backup_2023-06-15_03-00-00.zip (完整备份，大小：125MB)</label>
                            </div>
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="radio" name="backup-file" id="backup-2" style="margin-right: 10px;">
                                <label for="backup-2">backup_2023-06-14_03-00-00.zip (完整备份，大小：120MB)</label>
                            </div>
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="radio" name="backup-file" id="backup-3" style="margin-right: 10px;">
                                <label for="backup-3">backup_2023-06-13_03-00-00.zip (完整备份，大小：118MB)</label>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="submit-btn" onclick="startRestore()">开始恢复</button>
                            <button class="cancel-btn" onclick="closeRestoreModal()">取消</button>
                        </div>
                    </div>
                </div>
            </div>
        `);
    }

    // 关闭恢复备份模态框
    function closeRestoreModal() {
        $('#restore-modal').remove();
    }

    // 开始恢复备份
    function startRestore() {
        if (!$('input[name="backup-file"]:checked').length) {
            alert('请选择要恢复的备份文件');
            return;
        }
        
        if (confirm('恢复备份将覆盖当前数据，确定要继续吗？')) {
            closeRestoreModal();
            
            // 显示加载动画
            $('body').append('<div class="loader" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;"></div>');
            
            // 模拟恢复过程
            setTimeout(function() {
                $('.loader').remove();
                alert('备份恢复成功！系统将自动刷新。');
                // 这里可以添加实际的页面刷新逻辑
            }, 3000);
        }
    }
</script>

